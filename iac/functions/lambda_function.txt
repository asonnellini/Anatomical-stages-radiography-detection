import json
import base64
import boto3
import uuid

def lambda_handler(event, context):
    
    s3 = boto3.client("s3")
    
    get_file_content= event['content']
    
    decode_content = base64.b64decode(get_file_content)
    # TODO: get extension from content
    
    name = uuid.uuid4()
    key = str(name) + '.png'
    imageUploadBucket = 'deep-test'
    region ='eu-west-3'
    
    url = f'https://{imageUploadBucket}.s3-{region}.amazonaws.com/{key}'
    try:
        s3_upload = s3.put_object(Bucket=imageUploadBucket, Key=key, Body=decode_content)
        
        presigned_url = s3.generate_presigned_url('get_object',
                                                    Params={'Bucket': imageUploadBucket,
                                                            'Key': key},
                                                    ExpiresIn=expiration)
                                                    
        return {
        "statusCode": 200,
        "body": json.dumps("Hello from lambda"),
        "url": presigned_url
    }
    
    except Exception as e:
        return {
    
    